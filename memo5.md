# GGH 与 NTRU 签名方案的安全性分析

## 最近向量问题（CVP）

- 朴素算法（Babai 算法）
  - 将给定点用格基表示，然后把系数舍入到最近的整数
  - 几何意义是将格点周围的基本平行多面体映射到该点
    - 在格基正交程度较小时结果很差
  - 分析：
    - 正确映射的范围是以格点为中心的基本平行多面体内切球
    - 显然该球的直径应该是基本平行多面体各个超平面上『高』的最小值
    - $d=\min_k {\langle\prod_\times^{[1,n-1]}b_i,b_k\rangle \over |\prod_\times^{[1,n-1]}b_i|}=\min_k {\sum {A_k}_i{D_k}_i \over |[{D_k}]|}=\min_k {\sum {A_k}_iA^*_{ki} \over |[A^*_{ki}]|}=\min_k {1 \over |B'_k|}={1 \over max_k |B'_k|}$
      > **对偶基**：
      > - 对于一组基 $B=[b_1,b_2,...,b_n]$，如果基 $B'=[b'_1,b'_2,...,b'_n]$ 满足 $B^TB'=E$，那么这两组基对偶
      > - 显然，线性方程组 $Ax=b$ 的解就是 $x^T=(A^{-1}b)^T=b^TA'$

---
## GGH 签名方案及其攻击

> **数字签名**：
> - $Keygen()=(pk,sk)$：输出公私钥
> - $Sign(msg,sk)=sig$：用私钥 $sk$ 对 $msg$ 进行签名
> - $Verify((msg,sig),pk)=\{0,1\}$，验证 $msg$ 和 $sig$ 的对应关系
- GGH
  - Keygen：首先选择一个格 $L$ 及其两个格基，取其中比较『好』（正交性、格基较短）的格基为私钥 $sk$，另一个为公钥 $pk$
  - Sign：假设 $msg$ 是空间中的一个点，在基 $sk$ 下求 $CVP_{Babai}(msg)$
  - Verify：检查 $sig$ 在格基 $pk$ 下是否是格点，并且求 $|\vec {msg,sig}|$是否短
- 攻击
  - 假设攻击者获得了若干个信息以及签名
  - 平移每一对 $(msg,sig)$，使得 $sig=0$
  - 这时 $msg$ 的包络即是私钥张成的平行多面体
    - 通过一个试探向量 $u$ 来求包络
    - 考察 $\langle msg,u \rangle$ 的四阶矩：
      - $Kur(u)={1 \over 3}-{2 \over 15} \sum u_i^4$
      - 当 $u$ 取到多面体的表面时四阶矩达到峰值
    - 用一些奇怪的乱搞（梯度下降之类的...）获得 $u$